<div class="greybackground">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">
                <form name="userForm" class="settings" ng-submit="vm.update()">
                    <md-card ng-show="vm.profile" class="single-card">
                        <md-card-title>
                            <h1 class="cardformheader">Settings</h1>
                        </md-card-title>
                        <md-card-content>
                            <md-tabs md-dynamic-height md-border-bottom>
                                <md-tab label="Account">
                                    <md-content class="md-padding">
                                        <div ng-messages="vm.non_field_errors" class="text-center red">
                                            <div ng-message="server">{{ vm.formErrors.non_field_errors }}</div>
                                        </div>
                                        <md-input-container class="md-block">
                                            <label>Email</label>
                                            <input name="email" ng-model="vm.profile.email" type="email" required>
                                            <div ng-messages="userForm.email.$error">
                                                <div ng-message="required" class="my-message">Email is required.</div>
                                                <div ng-message="email" class="my-message">Invalid email format.</div>
                                                <div ng-message="server">{{ vm.formErrors.email }}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>Password</label>
                                            <input name="password" ng-model="vm.profile.password" type="password"
                                                   ng-minlength="7">
                                            <div ng-messages="userForm.password.$error">
                                                <div ng-message="minlength">Your password needs to be at least 7
                                                    characters.
                                                </div>
                                                <div ng-message="server">{{ vm.formErrors.password }}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>Confirm Password</label>
                                            <input name="confirm_password" ng-model="vm.profile.confirm_password"
                                                   type="password" ng-minlength="7">
                                            <div ng-messages="userForm.confirm_password.$error">
                                                <div ng-message="minlength">Your password needs to be at least 7
                                                    characters.
                                                </div>
                                                <div ng-message="server">{{ vm.formErrors.confirm_password }}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>Username</label>
                                            <input ng-model="vm.profile.username" type="text" disabled>
                                        </md-input-container>
                                        <div class="form-group text-right">
                                            <md-button type="button" ng-click="vm.destroy()"
                                                       class="btn md-raised md-accent btn-default pull-left">Delete
                                            </md-button>
                                            <md-button class="btn md-raised md-primary btn-default"
                                                       md-ink-ripple="#e9e9e9" type="submit">
                                                <span class="ng-scope">Update</span>
                                            </md-button>
                                        </div>
                                    </md-content>
                                </md-tab>
                                <md-tab label="Personal">
                                    <md-content class="md-padding">
                                        <md-input-container class="md-block">
                                            <div ngf-drop ng-model="vm.profile.avatar" ngf-pattern="image/*"
                                                 class="cropArea">
                                                <div class="text-center">
                                                    <img ng-src="{{ vm.croppedDataUrl }}" class="croppedArea"/>
                                                </div>
                                                <img-crop image="vm.profile.avatar | ngfDataUrl"
                                                          result-image="vm.croppedDataUrl" ng-init="croppedDataUrl=''">
                                                </img-crop>
                                            </div>
                                            <button ng-model="vm.profile.avatar" accept="image/*" ngf-select
                                                    class="md-primary md-hue-1 md-button pull-right">
                                                <span class="ng-scope">Change Picture</span>
                                            </button>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>First Name</label>
                                            <input name="first_name" ng-model="vm.profile.first_name" type="text">
                                            <div ng-messages="userForm.first_name.$error">
                                                <div ng-message="server">{{ vm.formErrors.first_name }}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>Last Name</label>
                                            <input name="last_name" ng-model="vm.profile.last_name" type="text">
                                            <div ng-messages="userForm.last_name.$error">
                                                <div ng-message="server">{{ vm.formErrors.last_name }}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>Address</label>
                                            <input name="address1" ng-model="vm.address.address1" type="text">
                                            <div ng-messages="userForm.address1.$error">
                                                <div ng-message="server">{{ vm.formErrors.address1 }}</div>
                                            </div>
                                        </md-input-container>
                                        <div class="row">
                                            <div class="col-xs-12 col-md-5">
                                                <md-input-container class="md-block">
                                                    <label>City</label>
                                                    <input name="city" ng-model="vm.address.city" type="text">
                                                    <div ng-messages="userForm.city.$error">
                                                        <div ng-message="server">{{ vm.formErrors.city }}</div>
                                                    </div>
                                                </md-input-container>
                                            </div>
                                            <div class="col-xs-4 col-md-3">
                                                <md-input-container class="md-block">
                                                    <label>State</label>
                                                    <md-select ng-model="vm.address.state" id="settings__state">
                                                        <md-option ng-repeat="state in vm.states"
                                                                   value="{{ state.abbrev }}">{{ state.abbrev }}
                                                        </md-option>
                                                    </md-select>
                                                    <div ng-messages="userForm.state.$error">
                                                        <div ng-message="server">{{ vm.formErrors.state }}</div>
                                                    </div>
                                                </md-input-container>
                                            </div>
                                            <div class="col-xs-8 col-md-4">
                                                <md-input-container class="md-block">
                                                    <label>Zip Code</label>
                                                    <input name="zip" ng-model="vm.address.zip"
                                                           ng-pattern="/^[0-9]{5}$/" md-maxlength="5">
                                                    <div ng-messages="userForm.zip.$error">
                                                        <div ng-message="pattern" class="my-message">That doesn't look
                                                            like a valid postal code.
                                                        </div>
                                                        <div ng-message="md-maxlength" class="my-message">
                                                            Please use the 5 digit zip code.
                                                        </div>
                                                        <div ng-message="server">{{ vm.formErrors.zip }}</div>
                                                    </div>
                                                </md-input-container>
                                            </div>
                                        </div>
                                        <div class="form-group text-right">
                                            <md-button class="btn md-raised md-primary btn-default"
                                                       md-ink-ripple="#e9e9e9"
                                                       type="submit"><span class="ng-scope">Update</span>
                                            </md-button>
                                        </div>
                                    </md-content>
                                </md-tab>
                            </md-tabs>
                        </md-card-content>
                    </md-card>
                </form>
            </div>
        </div>
    </div>
</div>